angular.module("objective-fire").factory("FactoryExtender",["$FirebaseObject","$firebase","$q","ObjectArray",function(a,b,c){return{createFactory:function(a){var b={},d=a.properties,e=(d.primitive,d.objectP,d.arrayP,a.objectMethods);for(param in e)b[param]=e[param];b.$load=function(a){var b=c.defer();return this._doLoad[a]=!0,this._loaded||this.$loaded().then(function(){}),b.promise}}}}]),angular.module("objective-fire").factory("FactoryExtender",["$FirebaseObject","$firebase","$q","PointerArray",function(a,b,c,d){return{createFactory:function(b,e,f){var g=b.getProperties(),g=(g.getNormalProperties(),g.getPointerObjectProperties(),g.getPointerArrayProperties(),g.getPointerDataProperties(),b.getDataProperties()),h=b.getPointerDataProperties(),i=b.getPointerListProperties();return a.$extendFactory({load:function(a){this._doLoad[a]=!0;var g=c.defer();return a in h?this.$loaded().then(function(b){var c=h[a].object;b[a]=f.getObjectClass(c).instance(b.pointers[a]),g.resolve(b[a])}):a in i?(console.log("loading the "+a),this.$loaded().then(function(c){var h=i[a].object,j=f.getObjectClass(h),k=e.child(b.getLocation()).child(c.$id).child("pointers").child(a);c[a]=new d(k,j),g.resolve(c[a])})):this.$loaded().then(function(b){g.resolve(b[a])}),g.promise},$$updated:function(a){var c=a.val(),g=!1;for(param in h)if(console.log("this is a pointer: "+param),this._doLoad[param]){console.log("we are going to load it");var j=h[param].object;console.log("this is the class we found for it: "+JSON.stringify(j)),c[param]=f.getObjectClass(j).instance(c.pointers[param])}for(param in i)if(console.log("this is a pointer list: "+param),this._doLoad[param]){console.log("we are going to load it");var k=i[param].object;console.log("this is the class we found for it: "+JSON.stringify(k));var l=f.getObjectClass(k),m=e.child(b.getLocation()).child(this.$id).child("pointers").child(param);console.log("the location "+param+" is being set to a pointer array"),c[param]=new d(m,l)}g=!0;for(param in c)this[param]=c[param];return g}})}}}]),angular.module("objective-fire").factory("FireObject",["$firebase","FactoryExtender",function(a,b){function c(a,c,d){this.objectClass=a,this.rootRef=c,this.objFire=d,this.factory=b.createFactory(this.objectClass,this.rootRef,this.objFire)}return c.prototype["new"]=function(){var b=this.rootRef.child(this.objectClass.name).push(),c=a(b,{objectFactory:this.factory}),d=c.$asObject();return d._loaded=!1,d.$loaded().then(function(){d._loaded=!0}),d._doLoad={},d.pointers={},null!=this.objectClass.objectConstructor&&this.objectClass.objectConstructor.apply(d,arguments),d.$save(),d},c.prototype.instance=function(b){var c=this.rootRef.child(this.objectClass.name).child(b),d=a(c,{objectFactory:this.factory}),e=d.$asObject();return e._loaded=!1,e.$loaded().then(function(){e._loaded=!0}),e._doLoad={},e.pointers={},e},c}]),angular.module("objective-fire").factory("ObjectArray",function(a,b){var c=function(b){return a.$extendFactory({$$added:function(a){return b.instance(a.key())},$$updated:function(a){return this.$getRecord(a.key())=b.instance(a.key()),!0}})};return function(a,d){var e=b(a,{arrayFactory:c(d)}),f=e.$asArray();return f}}),angular.module("objective-fire").factory("ObjectClass",function(){function a(b,c,d,e){return!this instanceof a?new a(b,c,d,e):(this.name=b,this.objectConstructor=c,this.objectMethods=d,void(this.properties=e))}return a}),angular.module("objective-fire",["firebase"]).factory("ObjectiveFire",["FireObject",function(a){function b(a){return!this instanceof b?new b(a):(this.ref=a,void(this.objects={}))}return b.prototype={registerObjectClass:function(b){return this.objects[b.name]=new a(objetClass,this.ref,this),this},getObjectClass:function(a){return this.objects[a]}},b}]),angular.module("objective-fire").factory("ObjectProperty",function(){function a(b,c){return!this instanceof a?new a(b,c):(this.name=b,void(this.objectClassName=c))}return a}).factory("ObjectArrayProperty",function(){function a(b,c){return!this instanceof ObjectProperty?new a(b,c):(this.name=b,void(this.objectClassName=c))}return a}).factory("PrimitiveProperty",function(){function a(b){return!this instanceof a?new a(b):void(this.name=b)}return a}).factory("Properties",["PrimitiveProperty","ObjectProperty","ObjectArrayProperty",function(a,b,c){function d(){return!this instanceof d?new d:(this.primitive=[],this.objectP=[],void(this.arrayP=[]))}return d.prototype={addProperty:function(d){return d instanceof a?this.primitive.push(d):d instanceof b?this.objectP.push(d):d instanceof c&&this.arrayP.push(d),this}},d}]);